<!DOCTYPE html><html lang="ru"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="Nosoff.info — personal blog"/><title>Класс для удобного манипулирования датами в ABAP</title><meta property="og:image" content="/assets/blog/zcl_date_abap/cover.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/8989f9f4657d19f0fcdb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8989f9f4657d19f0fcdb.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6dab348d518a0e6702e4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6dab348d518a0e6702e4.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-a3a79aff3ff232b41814.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f98b93c1570ecf70d9fa.js" defer=""></script><script src="/_next/static/chunks/853-ae4f3fbc7686be6d8798.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-27720eb20c91d7796fb9.js" defer=""></script><script src="/_next/static/WGLPwn0mPPHoFJAY34UX7/_buildManifest.js" defer=""></script><script src="/_next/static/WGLPwn0mPPHoFJAY34UX7/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/">Nosoff.info</a></h2><article class="mb-32"><h1 class="screenreader">Класс для удобного манипулирования датами в ABAP</h1><div class="hidden md:block md:mb-12"><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div class="mb-8 md:mb-16 -mx-5 sm:mx-0"><div class="-mx-5 sm:mx-0"><img src="/assets/blog/zcl_date_abap/cover.png" alt="Cover Image for Класс для удобного манипулирования датами в ABAP" class="shadow-small"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div class="mb-6 text-lg"><time dateTime="2020-05-24T14:15:07.322Z">May	24, 2020</time></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__1x9gM"><p>Настало время делиться своей болью и страданиями. Меня зовут Носов Роман, и, мне очень стыдно в этом признаться, но я <del>алкоголик</del> иногда пишу на <em>ABAP</em>, чтобы не умереть с голоду.</p>
<p><strong>Для тех, кто в танке и никогда не слышал, что это такое:</strong> <em>ABAP</em> — это внутренний язык, на котором программируют (допиливают напильником) разные продукты от <em>SAP</em> . От допиливаний страдают, как сама система, так и программисты с пользователями. И всё действо со стороны больше напоминает истязания грешников в каком-нибудь круге ада по Данте.</p>
<p>А <strong>SAP</strong> в свою очередь — <del>очень дорогая немецкая одинэска</del> компания которая делает ERP системы для крупных бизнесов.</p>
<p>Как сказал неизвестный мудрец в комментариях на хабре:
<img src="../assets/blog/zcl_date_abap/stalingrad.png" alt="SAP — это месть Гитлера за Сталинград"></p>
<h2>И тут мне захотелось немного уменьшить градус боли (по части работы с датами)</h2>
<h3>Для начала немного теории:</h3>
<p>В <em>ABAP</em> для хранения даты встроен специальный тип данных — <em>DATS</em> (или сокращенно — <em>D</em>). Представляет он из себя строку из 8 символов, в которой хранится по порядку: год,месяц,день. </p>
<p><strong>Например:</strong> '20190102' — это второе января 2019 года.</p>
<p>Так же, для этого типа данных перегружены действия + и -. Которые отнимают и прибавляют дни к дате, или считают разницу в днях между двумя датами.</p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">DATA</span><span class="token punctuation">:</span> lv_dats  <span class="token keyword">TYPE</span> dats<span class="token punctuation">,</span>
      lv_dats2 <span class="token keyword">TYPE</span> dats<span class="token punctuation">,</span>
      lv_int   <span class="token keyword">TYPE</span> <span class="token keyword">i</span><span class="token punctuation">.</span>

<span class="token eol-comment comment">" -/+ между dats и int возвращает dats с отнятыми/прибавленными днями</span>
lv_dats <span class="token operator">=</span> <span class="token string">'20190102'</span><span class="token punctuation">.</span>
lv_dats <span class="token operator">=</span> lv_dats <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">.</span>
<span class="token keyword">WRITE</span> lv_dats<span class="token punctuation">.</span> <span class="token eol-comment comment">" 28.12.2018</span>

<span class="token eol-comment comment">" -/+ между dats и dats возвращает int — разница между датами в днях</span>
lv_dats2 <span class="token operator">=</span> <span class="token string">'20190101'</span><span class="token punctuation">.</span>
lv_int <span class="token operator">=</span> lv_dats2 <span class="token operator">-</span> lv_dats<span class="token punctuation">.</span> <span class="token eol-comment comment">" 01.01.2019 -  28.12.2018</span>
<span class="token keyword">WRITE</span> lv_int<span class="token punctuation">.</span> <span class="token eol-comment comment">" 4</span>
</code></pre></div>
<p>Но что делать, если очень хочется сделать инкремент месяца (не + 30 дней, а именно получить то же число следующего месяца, независимо от длины месяца (28-31))?</p>
<p>Для этого есть громоздкий функциональный модуль RP_CALC_DATE_IN_INTERVAL. Умеет складывать/отнимать годы/месяцы/дни и возвращает валидную дату. </p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">DATA</span><span class="token punctuation">:</span> lv_dats  <span class="token keyword">TYPE</span> dats<span class="token punctuation">.</span>

lv_dats <span class="token operator">=</span> <span class="token string">'20190215'</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" 15.02.2019</span>

<span class="token keyword">CALL</span> <span class="token keyword">FUNCTION</span> <span class="token string">'RP_CALC_DATE_IN_INTERVAL'</span>
  <span class="token keyword">EXPORTING</span>
    <span class="token keyword">date</span>      <span class="token operator">=</span> lv_dats
    days      <span class="token operator">=</span> <span class="token number">0</span>
    months    <span class="token operator">=</span> <span class="token number">1</span>
    signum    <span class="token operator">=</span> <span class="token string">'+'</span>
    years     <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">IMPORTING</span>
    calc_date <span class="token operator">=</span> lv_dats<span class="token punctuation">.</span>

<span class="token keyword">write</span> lv_dats<span class="token punctuation">.</span> <span class="token eol-comment comment">" Искомое 15 марта</span>
</code></pre></div>
<p>Но вы точно хотите использовать в своих программах вот такие уродливые конструкции?</p>
<p>Отдельным пунктиком следует упомянуть про развлечения программистов с красивым форматированием даты. Огромные полотна кода с выдёргиваниями подстрок из даты, и конкатенации в нормальном виде.
<a href="https://www.erpworkbench.com/abap/date/date_format.htm" title="Formatting SAP date field using ABAP">Пример</a></p>
<p>А если очень хочется вместо номера месяца видеть его название? Май, апрель....</p>
<p>А если очень хочется видеть названия месяцев на том языке, на котором запущен SAP? :)
Огромные просторы для танцев с бубном и изобретаний велосипедов!</p>
<h2>Z* разработки в SAP — бесконечная фабрика велосипедов</h2>
<p><img src="../assets/blog/zcl_date_abap/meme.jpg" alt="worst programming language"></p>
<p>Итак, нам нужен класс, который мог инкапсулировать в себе стандартный dats, но предоставлять удобный <em>API</em> для работы с датами, максимально скрывая уродливость языка <em>ABAP</em>.</p>
<p>Он должен уметь:</p>
<ol>
<li>Прибавлять дни/месяцы/годы к текущей дате</li>
<li>Иметь адекватные геттеры/сеттеры для дней/месяцев/годов, скрывая работу с подстроками</li>
<li>Получать названия месяцев на заданном языке</li>
<li>Метод <em>to_string</em>, который возвращает строковое представление даты по заданной маске <em>(like printf)</em></li>
</ol>
<h2>Реализация:</h2>
<p>Создаём класс. В его свойствах будем хранить:</p>
<ol>
<li>Язык, который будет передаваться в конструкторе — (по умолчанию — язык системы)</li>
<li>Дата, которая аналогично будет передаваться в конструкторе — (по умолчанию — текущая)</li>
<li>Таблица названий месяцев для выбранного пользователем языка</li>
<li>Константы для метода to_string( )</li>
</ol>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">DATA</span><span class="token punctuation">:</span>
    gt_month_names <span class="token keyword">TYPE</span> <span class="token keyword">STANDARD</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> t247 <span class="token punctuation">.</span>
  <span class="token keyword">DATA</span> gv_language <span class="token keyword">TYPE</span> lang <span class="token punctuation">.</span>
  <span class="token keyword">DATA</span> gv_date <span class="token keyword">TYPE</span> dats <span class="token punctuation">.</span>
  <span class="token keyword">CONSTANTS</span> nv_long_year <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$yyyy'</span><span class="token punctuation">.</span>       
  <span class="token keyword">CONSTANTS</span> nv_short_year <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$yy'</span><span class="token punctuation">.</span>        
  <span class="token keyword">CONSTANTS</span> nv_month_name <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$m'</span><span class="token punctuation">.</span>         
  <span class="token keyword">CONSTANTS</span> nv_short_month_name <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$mmm'</span><span class="token punctuation">.</span> 
  <span class="token keyword">CONSTANTS</span> nv_month_number <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$mm'</span><span class="token punctuation">.</span>      
  <span class="token keyword">CONSTANTS</span> nv_day <span class="token keyword">TYPE</span> string <span class="token keyword">VALUE</span> <span class="token string">'$dd'</span><span class="token punctuation">.</span>               
</code></pre></div>
<p><strong>Конструктор и статический метод create</strong></p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token eol-comment comment">" Просто присваиваем значения </span>
  <span class="token keyword">METHOD</span> constructor<span class="token punctuation">.</span>
    gv_language <span class="token operator">=</span> iv_language<span class="token punctuation">.</span>
    gv_date <span class="token operator">=</span> iv_date<span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>

  <span class="token keyword">METHOD</span> <span class="token keyword">create</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" Что-то отдалённо похожее на фабричный метод,</span>
  <span class="token eol-comment comment">" только возвращаем инстанс самого класса zcl_date. </span>
  <span class="token eol-comment comment">" Таким образом избавляемся от громоздкой конструкции create object*</span>
  
    <span class="token keyword">CREATE</span> <span class="token keyword">OBJECT</span> ro_instance
      <span class="token keyword">EXPORTING</span>
        iv_date     <span class="token operator">=</span> iv_date
        iv_language <span class="token operator">=</span> iv_language<span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>
</code></pre></div>
<p>Прибавлять и вычитать будем уже известным функциональным модулем <em>RP_CALC_DATE_IN_INTERVAL</em>, но спрячем его поглубже, чтобы не было так страшно. Наружу (public) будут торчать два минималистичных метода: plus/minus</p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">METHOD</span> date_calculation<span class="token punctuation">.</span>
    <span class="token keyword">CALL</span> <span class="token keyword">FUNCTION</span> <span class="token string">'RP_CALC_DATE_IN_INTERVAL'</span>
      <span class="token keyword">EXPORTING</span>
        <span class="token keyword">date</span>      <span class="token operator">=</span> gv_date
        days      <span class="token operator">=</span> iv_days
        months    <span class="token operator">=</span> iv_months
        signum    <span class="token operator">=</span> iv_sign
        years     <span class="token operator">=</span> iv_years
      <span class="token keyword">IMPORTING</span>
        calc_date <span class="token operator">=</span> gv_date<span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>

  <span class="token keyword">METHOD</span> minus<span class="token punctuation">.</span>
    date_calculation<span class="token punctuation">(</span> iv_days   <span class="token operator">=</span> iv_days
                      iv_months <span class="token operator">=</span> iv_months
                      iv_years  <span class="token operator">=</span> iv_years
                      iv_sign   <span class="token operator">=</span> <span class="token string">'-'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>

  <span class="token keyword">METHOD</span> plus<span class="token punctuation">.</span>
    date_calculation<span class="token punctuation">(</span> iv_days   <span class="token operator">=</span> iv_days
                      iv_months <span class="token operator">=</span> iv_months
                      iv_years  <span class="token operator">=</span> iv_years
                      iv_sign   <span class="token operator">=</span> <span class="token string">'+'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>
</code></pre></div>
<p>Получать названия месяцев на текущем языке будем с помощью ФМ <em>MONTH_NAMES_GET</em>, который будем дёргать тогда, когда осознаем, что для этого языка у нас нет названий.</p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">METHOD</span> init_month_names<span class="token punctuation">.</span>
    <span class="token keyword">CALL</span> <span class="token keyword">FUNCTION</span> <span class="token string">'MONTH_NAMES_GET'</span>
      <span class="token keyword">EXPORTING</span>
        <span class="token keyword">language</span>              <span class="token operator">=</span> gv_language
      <span class="token keyword">TABLES</span>
        month_names           <span class="token operator">=</span> gt_month_names
      <span class="token keyword">EXCEPTIONS</span>
        month_names_not_found <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">OTHERS</span>                <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>

  <span class="token keyword">METHOD</span> get_month_name_by_number<span class="token punctuation">.</span>
    <span class="token keyword">DATA</span> ls_month <span class="token keyword">LIKE</span> <span class="token keyword">LINE</span> <span class="token keyword">OF</span> gt_month_names<span class="token punctuation">.</span>
  
    <span class="token eol-comment comment">" Есть ли вообще записи для текущего языка?</span>
    <span class="token keyword">READ</span> <span class="token keyword">TABLE</span> gt_month_names
      <span class="token keyword">INTO</span> ls_month
      <span class="token keyword">WITH</span> <span class="token keyword">KEY</span> spras <span class="token operator">=</span> gv_language<span class="token punctuation">.</span>
  
    <span class="token keyword">IF</span> sy<span class="token token-operator punctuation">-</span>subrc <span class="token operator">&#x3C;></span> <span class="token number">0</span><span class="token punctuation">.</span>
      init_month_names<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token keyword">ENDIF</span><span class="token punctuation">.</span>
  
    <span class="token keyword">CLEAR</span> ls_month<span class="token punctuation">.</span>
    <span class="token keyword">READ</span> <span class="token keyword">TABLE</span> gt_month_names
      <span class="token keyword">INTO</span> ls_month
      <span class="token keyword">WITH</span> <span class="token keyword">KEY</span>
        mnr   <span class="token operator">=</span> iv_number
        spras <span class="token operator">=</span> gv_language<span class="token punctuation">.</span>
  
    rv_month_name <span class="token operator">=</span> ls_month<span class="token token-operator punctuation">-</span>ltx<span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>
</code></pre></div>
<p>Ну и метод to_string( ). Который заменяет ключевые слова в маске значениями.</p>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">METHOD</span> to_string<span class="token punctuation">.</span>
    <span class="token keyword">DATA</span><span class="token punctuation">:</span>
      lv_day              <span class="token keyword">TYPE</span> num2<span class="token punctuation">,</span>
      lv_month_name       <span class="token keyword">TYPE</span> string<span class="token punctuation">,</span>
      lv_month_number     <span class="token keyword">TYPE</span> num2<span class="token punctuation">,</span>
      lv_short_month_name <span class="token keyword">TYPE</span> string<span class="token punctuation">,</span>
      lv_short_year       <span class="token keyword">TYPE</span> num2<span class="token punctuation">,</span>
      lv_long_year        <span class="token keyword">TYPE</span> num4<span class="token punctuation">.</span>

    lv_day <span class="token operator">=</span> get_day<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    lv_month_name <span class="token operator">=</span> get_month_name<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    lv_month_number <span class="token operator">=</span> get_month_number<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    lv_short_month_name <span class="token operator">=</span> get_short_month_name<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    lv_short_year <span class="token operator">=</span> get_short_year<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
    lv_long_year <span class="token operator">=</span> get_year<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>

    <span class="token eol-comment comment">" year</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_long_year <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_long_year <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_short_year <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_short_year <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>

    <span class="token eol-comment comment">" month</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_short_month_name <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_short_month_name <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_month_number <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_month_number <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_month_name <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_month_name <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>

    <span class="token eol-comment comment">"day</span>
    <span class="token keyword">REPLACE</span> <span class="token keyword">ALL</span> <span class="token keyword">OCCURRENCES</span> <span class="token keyword">OF</span> nv_day <span class="token keyword">IN</span> iv_format <span class="token keyword">WITH</span> lv_day <span class="token keyword">IGNORING</span> <span class="token keyword">CASE</span><span class="token punctuation">.</span>

    rv_string <span class="token operator">=</span> iv_format<span class="token punctuation">.</span>
  <span class="token keyword">ENDMETHOD</span><span class="token punctuation">.</span>
</code></pre></div>
<p>Осталось прикрутить геттеры/сеттеры. и доработать API.</p>
<p>Что в итоге получилось — можно посмотреть здесь: <a href="https://github.com/JustAddAcid/abap_date/" title="Класс для удобного использования даты в abap">github.com/JustAddAcid/abap_date</a></p>
<h2>Результаты</h2>
<ol>
<li>Минималистичные методы plus/minus</li>
</ol>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap">lo_date <span class="token operator">=</span> zcl_date<span class="token token-operator punctuation">=></span>create<span class="token punctuation">(</span> <span class="token string">'20200101'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" 01.01.2020</span>

lo_date<span class="token token-operator punctuation">-></span>minus<span class="token punctuation">(</span> iv_years <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" 01.01.2018</span>
lo_date<span class="token token-operator punctuation">-></span>plus<span class="token punctuation">(</span> iv_days <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>   <span class="token eol-comment comment">"04.01.2018</span>
lo_date<span class="token token-operator punctuation">-></span>plus<span class="token punctuation">(</span> iv_months <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token eol-comment comment">"04.02.2018</span>

<span class="token eol-comment comment">" Несколько аргументов</span>
lo_date<span class="token token-operator punctuation">-></span>plus<span class="token punctuation">(</span> 
    iv_days  <span class="token operator">=</span> <span class="token number">1</span>
    iv_years <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" 05.02.2020</span>
</code></pre></div>
<ol start="2">
<li>Геттеры/сеттеры</li>
<li>Метод get_month_name( ), получающий названия месяца</li>
</ol>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">data</span><span class="token punctuation">:</span> lo_date  <span class="token keyword">type</span> <span class="token keyword">ref</span> <span class="token keyword">to</span> zcl_date<span class="token punctuation">,</span>
      lv_dats  <span class="token keyword">type</span> dats<span class="token punctuation">,</span>
      lv_month <span class="token keyword">type</span> string<span class="token punctuation">.</span>

lo_date <span class="token operator">=</span> zcl_date<span class="token token-operator punctuation">=></span>create<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
lo_date<span class="token token-operator punctuation">-></span>set_year<span class="token punctuation">(</span> <span class="token number">2001</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
lo_date<span class="token token-operator punctuation">-></span>set_month_number<span class="token punctuation">(</span> <span class="token number">9</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
lo_date<span class="token token-operator punctuation">-></span>set_day<span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>

lv_dats <span class="token operator">=</span> lo_date<span class="token token-operator punctuation">-></span>get_date<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>
lv_month <span class="token operator">=</span> lo_date<span class="token token-operator punctuation">-></span>get_month_name<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>

<span class="token keyword">write</span> lv_dats<span class="token punctuation">.</span> <span class="token eol-comment comment">" 11 сентября 2001</span>
<span class="token keyword">write</span> lv_month<span class="token punctuation">.</span> <span class="token eol-comment comment">" Сентябрь</span>
</code></pre></div>
<ol start="4">
<li>Метод to_string( ), возвращающий строковое представление даты по маске</li>
</ol>
<div class="remark-highlight"><pre class="language-abap"><code class="language-abap"><span class="token keyword">data</span><span class="token punctuation">:</span> lo_date     <span class="token keyword">type</span> <span class="token keyword">ref</span> <span class="token keyword">to</span> zcl_date<span class="token punctuation">,</span>
      lv_formated <span class="token keyword">type</span> string<span class="token punctuation">.</span>

lo_date <span class="token operator">=</span> zcl_date<span class="token token-operator punctuation">=></span>create<span class="token punctuation">(</span> <span class="token string">'20200101'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token eol-comment comment">" 01.01.2020</span>
lv_formated <span class="token operator">=</span> lo_date<span class="token token-operator punctuation">-></span>to_string<span class="token punctuation">(</span> <span class="token string">'Месяц: $m Год: $yyyy День: $dd'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>

<span class="token keyword">write</span> lv_formated<span class="token punctuation">.</span> <span class="token eol-comment comment">" Месяц: Январь Год: 2020 День: 01</span>
</code></pre></div>
<p><a href="/tags/abap">#abap</a> </p>
</div></div></article><article class="mb-32 max-w-2xl mx-auto"><hr class="mb-5"/><h2 class="text-2xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-center">Комментарии</h2><div class="md:flex p-6">Loading...</div><a href="https://github.com/JustAddAcid/JustAddAcid.github.io/issues/8" class="bg-white hover:bg-gray-100 text-gray-800 font-semibold py-2 px-4 border border-gray-400 rounded shadow mt-2 inline-block">Добавить комментарий</a></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Класс для удобного манипулирования датами в ABAP","date":"2020-05-24T14:15:07.322Z","slug":"zcl-date-abap","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\u003cp\u003eНастало время делиться своей болью и страданиями. Меня зовут Носов Роман, и, мне очень стыдно в этом признаться, но я \u003cdel\u003eалкоголик\u003c/del\u003e иногда пишу на \u003cem\u003eABAP\u003c/em\u003e, чтобы не умереть с голоду.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eДля тех, кто в танке и никогда не слышал, что это такое:\u003c/strong\u003e \u003cem\u003eABAP\u003c/em\u003e — это внутренний язык, на котором программируют (допиливают напильником) разные продукты от \u003cem\u003eSAP\u003c/em\u003e . От допиливаний страдают, как сама система, так и программисты с пользователями. И всё действо со стороны больше напоминает истязания грешников в каком-нибудь круге ада по Данте.\u003c/p\u003e\n\u003cp\u003eА \u003cstrong\u003eSAP\u003c/strong\u003e в свою очередь — \u003cdel\u003eочень дорогая немецкая одинэска\u003c/del\u003e компания которая делает ERP системы для крупных бизнесов.\u003c/p\u003e\n\u003cp\u003eКак сказал неизвестный мудрец в комментариях на хабре:\n\u003cimg src=\"../assets/blog/zcl_date_abap/stalingrad.png\" alt=\"SAP — это месть Гитлера за Сталинград\"\u003e\u003c/p\u003e\n\u003ch2\u003eИ тут мне захотелось немного уменьшить градус боли (по части работы с датами)\u003c/h2\u003e\n\u003ch3\u003eДля начала немного теории:\u003c/h3\u003e\n\u003cp\u003eВ \u003cem\u003eABAP\u003c/em\u003e для хранения даты встроен специальный тип данных — \u003cem\u003eDATS\u003c/em\u003e (или сокращенно — \u003cem\u003eD\u003c/em\u003e). Представляет он из себя строку из 8 символов, в которой хранится по порядку: год,месяц,день. \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eНапример:\u003c/strong\u003e '20190102' — это второе января 2019 года.\u003c/p\u003e\n\u003cp\u003eТак же, для этого типа данных перегружены действия + и -. Которые отнимают и прибавляют дни к дате, или считают разницу в днях между двумя датами.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e lv_dats  \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e dats\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_dats2 \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e dats\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_int   \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ei\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token eol-comment comment\"\u003e\" -/+ между dats и int возвращает dats с отнятыми/прибавленными днями\u003c/span\u003e\nlv_dats \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'20190102'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlv_dats \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lv_dats \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eWRITE\u003c/span\u003e lv_dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 28.12.2018\u003c/span\u003e\n\n\u003cspan class=\"token eol-comment comment\"\u003e\" -/+ между dats и dats возвращает int — разница между датами в днях\u003c/span\u003e\nlv_dats2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'20190101'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlv_int \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lv_dats2 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e lv_dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 01.01.2019 -  28.12.2018\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eWRITE\u003c/span\u003e lv_int\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eНо что делать, если очень хочется сделать инкремент месяца (не + 30 дней, а именно получить то же число следующего месяца, независимо от длины месяца (28-31))?\u003c/p\u003e\n\u003cp\u003eДля этого есть громоздкий функциональный модуль RP_CALC_DATE_IN_INTERVAL. Умеет складывать/отнимать годы/месяцы/дни и возвращает валидную дату. \u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e lv_dats  \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\nlv_dats \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'20190215'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 15.02.2019\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eCALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFUNCTION\u003c/span\u003e \u003cspan class=\"token string\"\u003e'RP_CALC_DATE_IN_INTERVAL'\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eEXPORTING\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e      \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lv_dats\n    days      \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n    months    \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n    signum    \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'+'\u003c/span\u003e\n    years     \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eIMPORTING\u003c/span\u003e\n    calc_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lv_dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ewrite\u003c/span\u003e lv_dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" Искомое 15 марта\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eНо вы точно хотите использовать в своих программах вот такие уродливые конструкции?\u003c/p\u003e\n\u003cp\u003eОтдельным пунктиком следует упомянуть про развлечения программистов с красивым форматированием даты. Огромные полотна кода с выдёргиваниями подстрок из даты, и конкатенации в нормальном виде.\n\u003ca href=\"https://www.erpworkbench.com/abap/date/date_format.htm\" title=\"Formatting SAP date field using ABAP\"\u003eПример\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eА если очень хочется вместо номера месяца видеть его название? Май, апрель....\u003c/p\u003e\n\u003cp\u003eА если очень хочется видеть названия месяцев на том языке, на котором запущен SAP? :)\nОгромные просторы для танцев с бубном и изобретаний велосипедов!\u003c/p\u003e\n\u003ch2\u003eZ* разработки в SAP — бесконечная фабрика велосипедов\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"../assets/blog/zcl_date_abap/meme.jpg\" alt=\"worst programming language\"\u003e\u003c/p\u003e\n\u003cp\u003eИтак, нам нужен класс, который мог инкапсулировать в себе стандартный dats, но предоставлять удобный \u003cem\u003eAPI\u003c/em\u003e для работы с датами, максимально скрывая уродливость языка \u003cem\u003eABAP\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eОн должен уметь:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eПрибавлять дни/месяцы/годы к текущей дате\u003c/li\u003e\n\u003cli\u003eИметь адекватные геттеры/сеттеры для дней/месяцев/годов, скрывая работу с подстроками\u003c/li\u003e\n\u003cli\u003eПолучать названия месяцев на заданном языке\u003c/li\u003e\n\u003cli\u003eМетод \u003cem\u003eto_string\u003c/em\u003e, который возвращает строковое представление даты по заданной маске \u003cem\u003e(like printf)\u003c/em\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eРеализация:\u003c/h2\u003e\n\u003cp\u003eСоздаём класс. В его свойствах будем хранить:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eЯзык, который будет передаваться в конструкторе — (по умолчанию — язык системы)\u003c/li\u003e\n\u003cli\u003eДата, которая аналогично будет передаваться в конструкторе — (по умолчанию — текущая)\u003c/li\u003e\n\u003cli\u003eТаблица названий месяцев для выбранного пользователем языка\u003c/li\u003e\n\u003cli\u003eКонстанты для метода to_string( )\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    gt_month_names \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSTANDARD\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e t247 \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e gv_language \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e lang \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e gv_date \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e dats \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_long_year \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$yyyy'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e       \n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_short_year \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$yy'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e        \n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_month_name \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$m'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e         \n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_short_month_name \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$mmm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_month_number \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$mm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e      \n  \u003cspan class=\"token keyword\"\u003eCONSTANTS\u003c/span\u003e nv_day \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string \u003cspan class=\"token keyword\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'$dd'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e               \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eКонструктор и статический метод create\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token eol-comment comment\"\u003e\" Просто присваиваем значения \u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e constructor\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    gv_language \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_language\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    gv_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_date\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" Что-то отдалённо похожее на фабричный метод,\u003c/span\u003e\n  \u003cspan class=\"token eol-comment comment\"\u003e\" только возвращаем инстанс самого класса zcl_date. \u003c/span\u003e\n  \u003cspan class=\"token eol-comment comment\"\u003e\" Таким образом избавляемся от громоздкой конструкции create object*\u003c/span\u003e\n  \n    \u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOBJECT\u003c/span\u003e ro_instance\n      \u003cspan class=\"token keyword\"\u003eEXPORTING\u003c/span\u003e\n        iv_date     \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_date\n        iv_language \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_language\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eПрибавлять и вычитать будем уже известным функциональным модулем \u003cem\u003eRP_CALC_DATE_IN_INTERVAL\u003c/em\u003e, но спрячем его поглубже, чтобы не было так страшно. Наружу (public) будут торчать два минималистичных метода: plus/minus\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e date_calculation\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eCALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFUNCTION\u003c/span\u003e \u003cspan class=\"token string\"\u003e'RP_CALC_DATE_IN_INTERVAL'\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eEXPORTING\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e      \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gv_date\n        days      \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_days\n        months    \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_months\n        signum    \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_sign\n        years     \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_years\n      \u003cspan class=\"token keyword\"\u003eIMPORTING\u003c/span\u003e\n        calc_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gv_date\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e minus\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    date_calculation\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e iv_days   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_days\n                      iv_months \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_months\n                      iv_years  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_years\n                      iv_sign   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'-'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e plus\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    date_calculation\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e iv_days   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_days\n                      iv_months \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_months\n                      iv_years  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_years\n                      iv_sign   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'+'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eПолучать названия месяцев на текущем языке будем с помощью ФМ \u003cem\u003eMONTH_NAMES_GET\u003c/em\u003e, который будем дёргать тогда, когда осознаем, что для этого языка у нас нет названий.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e init_month_names\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eCALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFUNCTION\u003c/span\u003e \u003cspan class=\"token string\"\u003e'MONTH_NAMES_GET'\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eEXPORTING\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003elanguage\u003c/span\u003e              \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gv_language\n      \u003cspan class=\"token keyword\"\u003eTABLES\u003c/span\u003e\n        month_names           \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gt_month_names\n      \u003cspan class=\"token keyword\"\u003eEXCEPTIONS\u003c/span\u003e\n        month_names_not_found \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eOTHERS\u003c/span\u003e                \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e get_month_name_by_number\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e ls_month \u003cspan class=\"token keyword\"\u003eLIKE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eLINE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e gt_month_names\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \n    \u003cspan class=\"token eol-comment comment\"\u003e\" Есть ли вообще записи для текущего языка?\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREAD\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e gt_month_names\n      \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e ls_month\n      \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e spras \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gv_language\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \n    \u003cspan class=\"token keyword\"\u003eIF\u003c/span\u003e sy\u003cspan class=\"token token-operator punctuation\"\u003e-\u003c/span\u003esubrc \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n      init_month_names\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eENDIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \n    \u003cspan class=\"token keyword\"\u003eCLEAR\u003c/span\u003e ls_month\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREAD\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e gt_month_names\n      \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e ls_month\n      \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e\n        mnr   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_number\n        spras \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e gv_language\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \n    rv_month_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ls_month\u003cspan class=\"token token-operator punctuation\"\u003e-\u003c/span\u003eltx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eНу и метод to_string( ). Который заменяет ключевые слова в маске значениями.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003eMETHOD\u003c/span\u003e to_string\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eDATA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      lv_day              \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e num2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_month_name       \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_month_number     \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e num2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_short_month_name \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e string\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_short_year       \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e num2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_long_year        \u003cspan class=\"token keyword\"\u003eTYPE\u003c/span\u003e num4\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n    lv_day \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_day\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    lv_month_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_month_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    lv_month_number \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_month_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    lv_short_month_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_short_month_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    lv_short_year \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_short_year\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    lv_long_year \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e get_year\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n    \u003cspan class=\"token eol-comment comment\"\u003e\" year\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_long_year \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_long_year \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_short_year \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_short_year \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n    \u003cspan class=\"token eol-comment comment\"\u003e\" month\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_short_month_name \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_short_month_name \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_month_number \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_month_number \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_month_name \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_month_name \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n    \u003cspan class=\"token eol-comment comment\"\u003e\"day\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eREPLACE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOCCURRENCES\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOF\u003c/span\u003e nv_day \u003cspan class=\"token keyword\"\u003eIN\u003c/span\u003e iv_format \u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e lv_day \u003cspan class=\"token keyword\"\u003eIGNORING\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eCASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n    rv_string \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e iv_format\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eENDMETHOD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eОсталось прикрутить геттеры/сеттеры. и доработать API.\u003c/p\u003e\n\u003cp\u003eЧто в итоге получилось — можно посмотреть здесь: \u003ca href=\"https://github.com/JustAddAcid/abap_date/\" title=\"Класс для удобного использования даты в abap\"\u003egithub.com/JustAddAcid/abap_date\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eРезультаты\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eМинималистичные методы plus/minus\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003elo_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e zcl_date\u003cspan class=\"token token-operator punctuation\"\u003e=\u003e\u003c/span\u003ecreate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e'20200101'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 01.01.2020\u003c/span\u003e\n\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eminus\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e iv_years \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 01.01.2018\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eplus\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e iv_days \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e   \u003cspan class=\"token eol-comment comment\"\u003e\"04.01.2018\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eplus\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e iv_months \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\"04.02.2018\u003c/span\u003e\n\n\u003cspan class=\"token eol-comment comment\"\u003e\" Несколько аргументов\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eplus\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \n    iv_days  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n    iv_years \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 05.02.2020\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eГеттеры/сеттеры\u003c/li\u003e\n\u003cli\u003eМетод get_month_name( ), получающий названия месяца\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e lo_date  \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eref\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eto\u003c/span\u003e zcl_date\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_dats  \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e dats\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_month \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e string\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\nlo_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e zcl_date\u003cspan class=\"token token-operator punctuation\"\u003e=\u003e\u003c/span\u003ecreate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eset_year\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token number\"\u003e2001\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eset_month_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token number\"\u003e9\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eset_day\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token number\"\u003e11\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\nlv_dats \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eget_date\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nlv_month \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eget_month_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ewrite\u003c/span\u003e lv_dats\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 11 сентября 2001\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewrite\u003c/span\u003e lv_month\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" Сентябрь\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eМетод to_string( ), возвращающий строковое представление даты по маске\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-abap\"\u003e\u003ccode class=\"language-abap\"\u003e\u003cspan class=\"token keyword\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e lo_date     \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eref\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eto\u003c/span\u003e zcl_date\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      lv_formated \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e string\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\nlo_date \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e zcl_date\u003cspan class=\"token token-operator punctuation\"\u003e=\u003e\u003c/span\u003ecreate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e'20200101'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" 01.01.2020\u003c/span\u003e\nlv_formated \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e lo_date\u003cspan class=\"token token-operator punctuation\"\u003e-\u003e\u003c/span\u003eto_string\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Месяц: $m Год: $yyyy День: $dd'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ewrite\u003c/span\u003e lv_formated\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token eol-comment comment\"\u003e\" Месяц: Январь Год: 2020 День: 01\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca href=\"/tags/abap\"\u003e#abap\u003c/a\u003e \u003c/p\u003e\n","ogImage":{"url":"/assets/blog/zcl_date_abap/cover.png"},"coverImage":"/assets/blog/zcl_date_abap/cover.png","issueId":"8"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"zcl-date-abap"},"buildId":"WGLPwn0mPPHoFJAY34UX7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>