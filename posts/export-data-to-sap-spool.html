<!DOCTYPE html><html lang="ru"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="Nosoff.info — personal blog"/><title>Экспорт данных из SAP Query-отчета во внутреннюю таблицу через SPOOL</title><meta property="og:image" content="/assets/blog/export-data-to-sap-spool/background.jpg"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/ac13a076880d654a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ac13a076880d654a.css" data-n-g=""/><link rel="preload" href="/_next/static/css/96790406a55002be.css" as="style"/><link rel="stylesheet" href="/_next/static/css/96790406a55002be.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-f65e66e62fc5ca80.js" defer=""></script><script src="/_next/static/chunks/pages/_app-56332fb66f8b377f.js" defer=""></script><script src="/_next/static/chunks/782-caa534ae626186f6.js" defer=""></script><script src="/_next/static/chunks/673-45af6b13f6946d22.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b85e21d7939567c3.js" defer=""></script><script src="/_next/static/7ygb_69rKBS7LIVS6Fgxj/_buildManifest.js" defer=""></script><script src="/_next/static/7ygb_69rKBS7LIVS6Fgxj/_ssgManifest.js" defer=""></script><script src="/_next/static/7ygb_69rKBS7LIVS6Fgxj/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="min-h-screen"><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/">Nosoff.info</a></h2><article class="mb-32"><h1 class="screenreader">Экспорт данных из SAP Query-отчета во внутреннюю таблицу через SPOOL</h1><div class="hidden md:block md:mb-12"><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div class="mb-8 md:mb-16 -mx-5 sm:mx-0"><div class="-mx-5 sm:mx-0"><img src="/assets/blog/export-data-to-sap-spool/background.jpg" alt="Cover Image for Экспорт данных из SAP Query-отчета во внутреннюю таблицу через SPOOL" class="shadow-small"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div class="mb-6 text-lg"><time dateTime="2021-03-20T08:40:14.217Z">March	20, 2021</time></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__h_8de"><p>Господа, м'сье абапье и прочие любители подглядывать за страданиями! Представляю вашему вниманию очередной результат танцев с бубенцами. Который в этот раз будет чуть менее бесполезным. И (быть может) сэкономит время какому-нибудь заблудившемуся <strong>SAP</strong>-кодерасту.</p>
<p>Иногда хочется выть от боли, когда в очередной раз появляются требования выгрузки данных из стандартных или квази-стандартных отчетов SAP. Которые зачастую вообще не предусматривают какой-либо экспорт или расширение.</p>
<p>Дальше будет <strong>ABAP</strong> и рассказывания о подноготной <strong>SAP ERP</strong>. Если у вас нет вуайеристских наклонностей или профессионального интереса в дальнейшем тексте, то рекомендую закрыть страницу, чтобы не испытать экзистенциальный ужас от полученной информации.</p>
<p>Что ж, погружаемся, товарищи. Так сказать, пристегните ремни. Будет немного трясти <del>и пованивать</del>.</p>
<p><img src="../assets/blog/export-data-to-sap-spool/dipping.jpg" alt="Погружаемся!"></p>
<h2>Поехали.</h2>
<p>Итак, представим ситуацию: Вы сидите, неспешно ковыряете код. И тут прилетает задача —  достать данные из древнего отчета, нарисованного в <strong>SAP Query</strong> через <strong>Report painter</strong>; их немного обработать и отдать в другой интерфейс.</p>
<p>Казалось бы, что может быть сложного? Ну, например, всё. </p>
<h3>SAP Query (далее SQ)</h3>
<p>Это сраный <strong>SAP Query</strong>. Пользователь мышой натыкивает нужные ему поля и форму отчета, а на выходе получает готовый отчет. Софтина сама собирает ABAP-программу по конфигу. Класна? Нет. </p>
<p>Каждая дальнейшая правка отчета в пользовательской морде пересобирает целиком <em>всё</em>. Более того, никто не гарантирует, что программа пересоберется с тем же техническим названием. Ну и при переезде правок по ландшафту дев-тест-прод -> будет генерироваться разное название.</p>
<p><strong>Вывод:</strong> Вписаться в код отчета и вытащить данные перед их отображением —  не получится. Юзверь перезатрёт всё прямзавтра. А скорее всего —  вчера.</p>
<p><img src="../assets/blog/export-data-to-sap-spool/userflow.jpg" alt="userflow"></p>
<h3>Report Painter</h3>
<p>Я нарвался на <em>"не совсем классическое"</em>  использование <strong>SQ</strong>! Данные выводятся не напрямую, а проходят через <em>"прослойку отрисовщика"</em> (Report Painter). И воспользоваться стандартным FM <strong>RSAQ_REMOTE_QUERY_CALL</strong>, увы, не выйдет. </p>
<p>Т.к. для заданного отчета вообще нет таких параметров, как <em>"имя запроса"</em> и  <em>"группа пользователей"</em>. Просто н<strong>е</strong>чего подавать в аргументы функции.</p>
<p><strong>Вывод:</strong> Увы, воспользоваться предусмотренными FM невозможно. </p>
<h3>Это, мать вашу, не ALV</h3>
<p>А жаль. При отображении, ALV-таблицы постят свои мета-(и не очень мета)данные в глобальный скоуп сессии пользователя. И оттуда элементарно вытащить что угодно. Например, вот так:</p>
<pre><code class="language-abap">cl_salv_bs_runtime_info=>set( EXPORTING display  = abap_false  
                                        metadata = abap_true  
                                        data     = abap_true ).
                                        
" submit report and return

cl_salv_bs_runtime_info=>get_data_ref( IMPORTING r_data = ro_data ).

" do with ro_data what you want
</code></pre>
<h3>Не работает ... exporting list to memory</h3>
<p>Необъяснимо, но факт. Несмотря на то, что SQ-отчеты де-факто рендерят стандартный лист!</p>
<p>Попытка экспортировать таким способом просто подвешивает основной поток выполнения и ничего не делает. Чому? Об этом знает только аллах. </p>
<pre><code class="language-abap">submit prog and return exporting list to memory. " not working
</code></pre>
<h3>Но выход всегда есть</h3>
<p><em>(особенно, если вы живёте достаточно высоко)</em></p>
<p>Давайте подумаем, <strong>что может быть общего</strong> между матричными принтерами, и решением моей задачи? </p>
<p><img src="../assets/blog/export-data-to-sap-spool/printer.jpeg" alt="printer"></p>
<p>Да, теми самыми принтерами с рулоном ленты. Которые буквально печатают "стуча" по бумаге, как старые печатающие машинки. И которые могут использовать только <em>ASCII</em> символы. </p>
<p><strong>А то</strong>, что <strong>SAP</strong> <em>(Эдакая древняя громадина)</em> из коробки поддерживает <em>ASCII</em>-фикацию и печать всех отчетов, которые отрисовываются "стандартным" способом. Так это же то, что мне нужно! Такой текст будет элементарно распарсить после получения.</p>
<p>Достаточно дёрнуть печать отчета, и вовремя подхватить <em>ASCII</em>-фицированный документ кодом! Получается что-то вроде этого:</p>
<p>Создаём фоновое задание, где будет выполняться рендеринг и попытка печати.</p>
<pre><code class="language-abap">CALL FUNCTION 'JOB_OPEN'
  EXPORTING
    jobname          = kv_job_name
  IMPORTING
    jobcount         = lv_jobcount.
</code></pre>
<p>Собираем параметры печати. Нам нужно попросить программу напечататься сразу же после выполнения, и не показывать никаких диалогов. </p>
<pre><code class="language-abap">CALL FUNCTION 'GET_PRINT_PARAMETERS'
  EXPORTING
    list_name      = 'TEST'
    list_text      = 'SUBMIT this fucking program TO SAP-SPOOL'
    immediately    = abap_true
    no_dialog      = abap_true
  IMPORTING
    out_parameters = ls_params
    valid          = lv_valid.
</code></pre>
<p>Вызываем программу в фоне со всеми собранными параметрами. Конструкция <strong>to sap-spool ... without spool</strong> нисколько сап не смущает. И вполне корректно отрабатывает. </p>
<pre><code class="language-abap">SUBMIT program_technical_name USING SELECTION-SET 'VAR1' 
      TO SAP-SPOOL SPOOL PARAMETERS ls_params 
      WITHOUT SPOOL DYNPRO 
      VIA JOB kv_job_name NUMBER lv_jobcount 
      AND RETURN.
</code></pre>
<p>Так, программу мы вызвали, теперь придется костылём дожидаться завершения фоновой задачи. Никаких ивентов и коллбэков тут нет. </p>
<pre><code class="language-abap">" Костыль ожидания завершения асинхронной жобы
WHILE ls_empty IS INITIAL.
  WAIT UP TO 5 SECONDS.
  SELECT SINGLE * FROM tbtco INTO ls_empty WHERE jobname = kv_job_name AND jobcount = lv_jobcount AND status = 'F'.
ENDWHILE.
</code></pre>
<p>Ну, собственно, всё. Фоновая задача завершена. В системе уже хранятся отрендеренные данные, и нам остаётся лишь их подхватить. </p>
<pre><code class="language-abap">SELECT SINGLE listident
  FROM tbtcp
  INTO lv_listident
  WHERE jobname = kv_job_name
    AND jobcount = lv_jobcount.
 
CHECK lv_listident IS NOT INITIAL.
 
lv_rqident = lv_listident.
 
CALL FUNCTION 'RSPO_RETURN_ABAP_SPOOLJOB'
  EXPORTING
    rqident              = lv_rqident
  TABLES
    buffer               = lt_buffer.
</code></pre>
<p>В результате получаем внутрённюю таблицу <strong>lt_buffer</strong> из строк отчета. Её элементарно разбирать на куски, и вытаскивать нужные нам значения.</p>
<p>Столбцы в такой таблице разделены символом вертикальной черты '|' и ничего не стоит распарсить поля по отдельности. </p>
<p><a href="https://gist.github.com/JustAddAcid/450d4cd5f1069dbac61c3e842508b969">Полный код на github gists здесь</a></p>
<iframe frameborder="0" style="border:none;width:100%;height:180px;" width="100%" height="180" src="https://music.yandex.ru/iframe/#track/57987781/8763763">Слушайте <a href='https://music.yandex.ru/album/8763763/track/57987781'>What the Fuck</a> — <a href='https://music.yandex.ru/artist/7756103'>RHODAMINE</a> на Яндекс.Музыке</iframe>
<p><a href="/tags/abap">#abap</a> <a href="/tags/%D1%82%D0%B0%D0%BD%D1%86%D1%8B_%D1%81_%D0%B1%D1%83%D0%B1%D0%BD%D0%BE%D0%BC">#танцы<em>с</em>бубном</a></p>
</div></div></article><article class="mb-32 max-w-2xl mx-auto"><hr class="mb-5"/><h2 class="text-2xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-center">Комментарии</h2><div class="md:flex p-6">Loading...</div><a href="https://github.com/JustAddAcid/JustAddAcid.github.io/issues/18" class="bg-white hover:bg-gray-100 text-gray-800 font-semibold py-2 px-4 border border-gray-400 rounded shadow mt-2 inline-block">Добавить комментарий</a></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Экспорт данных из SAP Query-отчета во внутреннюю таблицу через SPOOL","date":"2021-03-20T08:40:14.217Z","slug":"export-data-to-sap-spool","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\u003cp\u003eГоспода, м'сье абапье и прочие любители подглядывать за страданиями! Представляю вашему вниманию очередной результат танцев с бубенцами. Который в этот раз будет чуть менее бесполезным. И (быть может) сэкономит время какому-нибудь заблудившемуся \u003cstrong\u003eSAP\u003c/strong\u003e-кодерасту.\u003c/p\u003e\n\u003cp\u003eИногда хочется выть от боли, когда в очередной раз появляются требования выгрузки данных из стандартных или квази-стандартных отчетов SAP. Которые зачастую вообще не предусматривают какой-либо экспорт или расширение.\u003c/p\u003e\n\u003cp\u003eДальше будет \u003cstrong\u003eABAP\u003c/strong\u003e и рассказывания о подноготной \u003cstrong\u003eSAP ERP\u003c/strong\u003e. Если у вас нет вуайеристских наклонностей или профессионального интереса в дальнейшем тексте, то рекомендую закрыть страницу, чтобы не испытать экзистенциальный ужас от полученной информации.\u003c/p\u003e\n\u003cp\u003eЧто ж, погружаемся, товарищи. Так сказать, пристегните ремни. Будет немного трясти \u003cdel\u003eи пованивать\u003c/del\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../assets/blog/export-data-to-sap-spool/dipping.jpg\" alt=\"Погружаемся!\"\u003e\u003c/p\u003e\n\u003ch2\u003eПоехали.\u003c/h2\u003e\n\u003cp\u003eИтак, представим ситуацию: Вы сидите, неспешно ковыряете код. И тут прилетает задача —  достать данные из древнего отчета, нарисованного в \u003cstrong\u003eSAP Query\u003c/strong\u003e через \u003cstrong\u003eReport painter\u003c/strong\u003e; их немного обработать и отдать в другой интерфейс.\u003c/p\u003e\n\u003cp\u003eКазалось бы, что может быть сложного? Ну, например, всё. \u003c/p\u003e\n\u003ch3\u003eSAP Query (далее SQ)\u003c/h3\u003e\n\u003cp\u003eЭто сраный \u003cstrong\u003eSAP Query\u003c/strong\u003e. Пользователь мышой натыкивает нужные ему поля и форму отчета, а на выходе получает готовый отчет. Софтина сама собирает ABAP-программу по конфигу. Класна? Нет. \u003c/p\u003e\n\u003cp\u003eКаждая дальнейшая правка отчета в пользовательской морде пересобирает целиком \u003cem\u003eвсё\u003c/em\u003e. Более того, никто не гарантирует, что программа пересоберется с тем же техническим названием. Ну и при переезде правок по ландшафту дев-тест-прод -\u003e будет генерироваться разное название.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eВывод:\u003c/strong\u003e Вписаться в код отчета и вытащить данные перед их отображением —  не получится. Юзверь перезатрёт всё прямзавтра. А скорее всего —  вчера.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../assets/blog/export-data-to-sap-spool/userflow.jpg\" alt=\"userflow\"\u003e\u003c/p\u003e\n\u003ch3\u003eReport Painter\u003c/h3\u003e\n\u003cp\u003eЯ нарвался на \u003cem\u003e\"не совсем классическое\"\u003c/em\u003e  использование \u003cstrong\u003eSQ\u003c/strong\u003e! Данные выводятся не напрямую, а проходят через \u003cem\u003e\"прослойку отрисовщика\"\u003c/em\u003e (Report Painter). И воспользоваться стандартным FM \u003cstrong\u003eRSAQ_REMOTE_QUERY_CALL\u003c/strong\u003e, увы, не выйдет. \u003c/p\u003e\n\u003cp\u003eТ.к. для заданного отчета вообще нет таких параметров, как \u003cem\u003e\"имя запроса\"\u003c/em\u003e и  \u003cem\u003e\"группа пользователей\"\u003c/em\u003e. Просто н\u003cstrong\u003eе\u003c/strong\u003eчего подавать в аргументы функции.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eВывод:\u003c/strong\u003e Увы, воспользоваться предусмотренными FM невозможно. \u003c/p\u003e\n\u003ch3\u003eЭто, мать вашу, не ALV\u003c/h3\u003e\n\u003cp\u003eА жаль. При отображении, ALV-таблицы постят свои мета-(и не очень мета)данные в глобальный скоуп сессии пользователя. И оттуда элементарно вытащить что угодно. Например, вот так:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003ecl_salv_bs_runtime_info=\u003eset( EXPORTING display  = abap_false  \n                                        metadata = abap_true  \n                                        data     = abap_true ).\n                                        \n\" submit report and return\n\ncl_salv_bs_runtime_info=\u003eget_data_ref( IMPORTING r_data = ro_data ).\n\n\" do with ro_data what you want\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eНе работает ... exporting list to memory\u003c/h3\u003e\n\u003cp\u003eНеобъяснимо, но факт. Несмотря на то, что SQ-отчеты де-факто рендерят стандартный лист!\u003c/p\u003e\n\u003cp\u003eПопытка экспортировать таким способом просто подвешивает основной поток выполнения и ничего не делает. Чому? Об этом знает только аллах. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003esubmit prog and return exporting list to memory. \" not working\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eНо выход всегда есть\u003c/h3\u003e\n\u003cp\u003e\u003cem\u003e(особенно, если вы живёте достаточно высоко)\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eДавайте подумаем, \u003cstrong\u003eчто может быть общего\u003c/strong\u003e между матричными принтерами, и решением моей задачи? \u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../assets/blog/export-data-to-sap-spool/printer.jpeg\" alt=\"printer\"\u003e\u003c/p\u003e\n\u003cp\u003eДа, теми самыми принтерами с рулоном ленты. Которые буквально печатают \"стуча\" по бумаге, как старые печатающие машинки. И которые могут использовать только \u003cem\u003eASCII\u003c/em\u003e символы. \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eА то\u003c/strong\u003e, что \u003cstrong\u003eSAP\u003c/strong\u003e \u003cem\u003e(Эдакая древняя громадина)\u003c/em\u003e из коробки поддерживает \u003cem\u003eASCII\u003c/em\u003e-фикацию и печать всех отчетов, которые отрисовываются \"стандартным\" способом. Так это же то, что мне нужно! Такой текст будет элементарно распарсить после получения.\u003c/p\u003e\n\u003cp\u003eДостаточно дёрнуть печать отчета, и вовремя подхватить \u003cem\u003eASCII\u003c/em\u003e-фицированный документ кодом! Получается что-то вроде этого:\u003c/p\u003e\n\u003cp\u003eСоздаём фоновое задание, где будет выполняться рендеринг и попытка печати.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003eCALL FUNCTION 'JOB_OPEN'\n  EXPORTING\n    jobname          = kv_job_name\n  IMPORTING\n    jobcount         = lv_jobcount.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eСобираем параметры печати. Нам нужно попросить программу напечататься сразу же после выполнения, и не показывать никаких диалогов. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003eCALL FUNCTION 'GET_PRINT_PARAMETERS'\n  EXPORTING\n    list_name      = 'TEST'\n    list_text      = 'SUBMIT this fucking program TO SAP-SPOOL'\n    immediately    = abap_true\n    no_dialog      = abap_true\n  IMPORTING\n    out_parameters = ls_params\n    valid          = lv_valid.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eВызываем программу в фоне со всеми собранными параметрами. Конструкция \u003cstrong\u003eto sap-spool ... without spool\u003c/strong\u003e нисколько сап не смущает. И вполне корректно отрабатывает. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003eSUBMIT program_technical_name USING SELECTION-SET 'VAR1' \n      TO SAP-SPOOL SPOOL PARAMETERS ls_params \n      WITHOUT SPOOL DYNPRO \n      VIA JOB kv_job_name NUMBER lv_jobcount \n      AND RETURN.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eТак, программу мы вызвали, теперь придется костылём дожидаться завершения фоновой задачи. Никаких ивентов и коллбэков тут нет. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003e\" Костыль ожидания завершения асинхронной жобы\nWHILE ls_empty IS INITIAL.\n  WAIT UP TO 5 SECONDS.\n  SELECT SINGLE * FROM tbtco INTO ls_empty WHERE jobname = kv_job_name AND jobcount = lv_jobcount AND status = 'F'.\nENDWHILE.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eНу, собственно, всё. Фоновая задача завершена. В системе уже хранятся отрендеренные данные, и нам остаётся лишь их подхватить. \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-abap\"\u003eSELECT SINGLE listident\n  FROM tbtcp\n  INTO lv_listident\n  WHERE jobname = kv_job_name\n    AND jobcount = lv_jobcount.\n \nCHECK lv_listident IS NOT INITIAL.\n \nlv_rqident = lv_listident.\n \nCALL FUNCTION 'RSPO_RETURN_ABAP_SPOOLJOB'\n  EXPORTING\n    rqident              = lv_rqident\n  TABLES\n    buffer               = lt_buffer.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eВ результате получаем внутрённюю таблицу \u003cstrong\u003elt_buffer\u003c/strong\u003e из строк отчета. Её элементарно разбирать на куски, и вытаскивать нужные нам значения.\u003c/p\u003e\n\u003cp\u003eСтолбцы в такой таблице разделены символом вертикальной черты '|' и ничего не стоит распарсить поля по отдельности. \u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gist.github.com/JustAddAcid/450d4cd5f1069dbac61c3e842508b969\"\u003eПолный код на github gists здесь\u003c/a\u003e\u003c/p\u003e\n\u003ciframe frameborder=\"0\" style=\"border:none;width:100%;height:180px;\" width=\"100%\" height=\"180\" src=\"https://music.yandex.ru/iframe/#track/57987781/8763763\"\u003eСлушайте \u003ca href='https://music.yandex.ru/album/8763763/track/57987781'\u003eWhat the Fuck\u003c/a\u003e — \u003ca href='https://music.yandex.ru/artist/7756103'\u003eRHODAMINE\u003c/a\u003e на Яндекс.Музыке\u003c/iframe\u003e\n\u003cp\u003e\u003ca href=\"/tags/abap\"\u003e#abap\u003c/a\u003e \u003ca href=\"/tags/%D1%82%D0%B0%D0%BD%D1%86%D1%8B_%D1%81_%D0%B1%D1%83%D0%B1%D0%BD%D0%BE%D0%BC\"\u003e#танцы\u003cem\u003eс\u003c/em\u003eбубном\u003c/a\u003e\u003c/p\u003e\n","ogImage":{"url":"/assets/blog/export-data-to-sap-spool/background.jpg"},"coverImage":"/assets/blog/export-data-to-sap-spool/background.jpg","issueId":"18"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"export-data-to-sap-spool"},"buildId":"7ygb_69rKBS7LIVS6Fgxj","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>